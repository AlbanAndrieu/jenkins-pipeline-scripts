   Jenkinsfile.run()
      Jenkinsfile.dockerImageTag({isLatest=true})
      Jenkinsfile.dockerTag()
      Jenkinsfile.getDockerOpts({isDockerCompose=false, isLocalJenkinsUser=false})
      Jenkinsfile.pipeline(groovy.lang.Closure)
         Jenkinsfile.agent(groovy.lang.Closure)
            Jenkinsfile.docker(groovy.lang.Closure)
               Jenkinsfile.image(nabla/ansible-jenkins-slave-docker:latest)
               Jenkinsfile.alwaysPull(true)
               Jenkinsfile.reuseNode(true)
               Jenkinsfile.registryUrl(https://index.docker.io/v1)
               Jenkinsfile.registryCredentialsId(hub-docker-nabla)
               Jenkinsfile.args(-v /home/jenkins:/home/jenkins -v /etc/passwd:/etc/passwd:ro -v /etc/group:/etc/group:ro -v /var/run/docker.sock:/var/run/docker.sock)
               Jenkinsfile.label(molecule)
         Jenkinsfile.parameters(groovy.lang.Closure)
            Jenkinsfile.booleanParam({defaultValue=false, description=Dry run, name=DRY_RUN})
            Jenkinsfile.booleanParam({defaultValue=false, description=Clean before run, name=CLEAN_RUN})
            Jenkinsfile.booleanParam({defaultValue=false, description=Debug run, name=DEBUG_RUN})
            Jenkinsfile.booleanParam({defaultValue=false, description=Debug mvnw, name=MVNW_VERBOSE})
            Jenkinsfile.booleanParam({defaultValue=false, name=RELEASE, description=Perform release-type build.})
            Jenkinsfile.string({defaultValue=, name=RELEASE_BASE, description=Commit tag or branch that should be checked-out for release})
            Jenkinsfile.string({defaultValue=1.0.0, name=RELEASE_VERSION, description=Release version for artifacts})
            Jenkinsfile.booleanParam({defaultValue=false, description=Build only to have package. no test / no docker, name=BUILD_ONLY})
            Jenkinsfile.booleanParam({defaultValue=false, description=Run acceptance tests, name=BUILD_TEST})
            Jenkinsfile.booleanParam({defaultValue=false, description=Build gradle, name=BUILD_GRADLE})
            Jenkinsfile.booleanParam({defaultValue=false, description=Build jenkins docker images, name=BUILD_DOCKER})
            Jenkinsfile.booleanParam({defaultValue=false, description=Build with sonar, name=BUILD_SONAR})
         Jenkinsfile.options(groovy.lang.Closure)
            Jenkinsfile.disableConcurrentBuilds()
            Jenkinsfile.parallelsAlwaysFailFast()
            Jenkinsfile.ansiColor(xterm)
            Jenkinsfile.timeout({time=180, unit=MINUTES})
            Jenkinsfile.timestamps()
         Jenkinsfile.stages(groovy.lang.Closure)
            Jenkinsfile.stage(Setup, groovy.lang.Closure)
               Jenkinsfile.steps(groovy.lang.Closure)
                  Jenkinsfile.script(groovy.lang.Closure)
                     Jenkinsfile.setUp({description=JPL})
                     Jenkinsfile.load(src/test/jenkins/lib/myenv.groovy)
                        myenv.run()
                     myenv.getPropertyList()
                     Jenkinsfile.properties([])
                     myenv.printEnvironment()
                        myenv.println(COMPOSE_HTTP_TIMEOUT = 200)
            Jenkinsfile.stage(➡ Build - Maven, groovy.lang.Closure)
               Jenkinsfile.when(groovy.lang.Closure)
                  Jenkinsfile.expression(groovy.lang.Closure)
               Jenkinsfile.steps(groovy.lang.Closure)
                  Jenkinsfile.script(groovy.lang.Closure)
                     Jenkinsfile.sh(echo TEST : master)
                     Jenkinsfile.withMavenWrapper({goal=install, skipSonar=true, skipPitest=true, skipArtifacts=true, buildCmdParameters=-Dserver=jetty9x, skipMavenSettings=false, artifacts=**/target/dependency/jetty-runner.jar, **/target/test-config.jar, **/target/test.war, **/target/*.zip})
                     Jenkinsfile.withShellCheckWrapper({pattern=*.sh})
                     Jenkinsfile.step({$class=CoberturaPublisher, autoUpdateHealth=false, autoUpdateStability=false, coberturaReportFile=**/coverage.xml, failUnhealthy=false, failUnstable=false, failNoReports=false, maxNumberOfBuilds=0, onlyStable=false, sourceEncoding=ASCII, zoomCoverageChart=false})
                     Jenkinsfile.mavenConsole()
                     Jenkinsfile.java({reportEncoding=UTF-8})
                     Jenkinsfile.javaDoc()
                     Jenkinsfile.spotBugs()
                     Jenkinsfile.cpd({pattern=**/target/cpd.xml})
                     Jenkinsfile.pmdParser({pattern=**/target/pmd.xml})
                     Jenkinsfile.excludeFile(.*\/target\/.*)
                     Jenkinsfile.excludeFile(node_modules\/.*)
                     Jenkinsfile.excludeFile(npm\/.*)
                     Jenkinsfile.excludeFile(bower_components\/.*)
                     Jenkinsfile.recordIssues({enabledForFailure=true, aggregatingResults=true, id=analysis-java-jps, tools=[null, null, null, null, null, null], filters=[null, null, null, null]})
            Jenkinsfile.stage(➡ Build - Gradle, groovy.lang.Closure)
               Jenkinsfile.when(groovy.lang.Closure)
                  Jenkinsfile.expression(groovy.lang.Closure)
                  Jenkinsfile.expression(groovy.lang.Closure)
               Jenkinsfile.steps(groovy.lang.Closure)
                  Jenkinsfile.script(groovy.lang.Closure)
                     Jenkinsfile.sh(echo JAVA_HOME : )
                     Jenkinsfile.sh(echo HOME : )
                     Jenkinsfile.sh(pwd && ls -lrta /jenkins/ || true)
                     Jenkinsfile.sh(ls -lrta /jenkins/.gradle || true)
                     Jenkinsfile.sh(mkdir -p /jenkins/.gradle || true)
                     Jenkinsfile.sh(export HOME=/jenkins/home && ./gradlew build --stacktrace || true)
                     Jenkinsfile.publishHTML({target={allowMissing=true, alwaysLinkToLastBuild=false, keepAll=true, reportDir=build/reports/tests/test/, reportFiles=index.html, reportName=Gradle Report}})
            Jenkinsfile.stage(➕ Quality - SonarQube analysis, groovy.lang.Closure)
               Jenkinsfile.when(groovy.lang.Closure)
                  Jenkinsfile.expression(groovy.lang.Closure)
                  Jenkinsfile.expression(groovy.lang.Closure)
               Jenkinsfile.environment(groovy.lang.Closure)
               Jenkinsfile.steps(groovy.lang.Closure)
                  Jenkinsfile.script(groovy.lang.Closure)
                     Jenkinsfile.withSonarQubeWrapper({verbose=true, skipFailure=false, skipSonarCheck=false, skipMaven=true, isScannerHome=false, sonarExecutable=/usr/local/sonar-runner/bin/sonar-scanner, reportTaskFile=.scannerwork/report-task.txt, project=NABLA, repository=jenkins-pipeline-scripts})
            Jenkinsfile.stage(➡ Build - Docker, groovy.lang.Closure)
               Jenkinsfile.when(groovy.lang.Closure)
                  Jenkinsfile.expression(groovy.lang.Closure)
                  Jenkinsfile.expression(groovy.lang.Closure)
               Jenkinsfile.steps(groovy.lang.Closure)
                  Jenkinsfile.script(groovy.lang.Closure)
                     Jenkinsfile.tee(docker-build.log, groovy.lang.Closure)
                        Jenkinsfile.dockerHadoLint({dockerFilePath=./, skipDockerLintFailure=true, dockerFileId=1})
                        Jenkinsfile.sh(echo DEBUGING image : $PATH)
                        Jenkinsfile.sh(git --version || true)
                        Jenkinsfile.sh(java -version || true)
                        Jenkinsfile.sh(id jenkins || true)
                        Jenkinsfile.sh(ls -lrta)
                        Jenkinsfile.sh(date > /tmp/test.txt)
                        Jenkinsfile.sh(cp /tmp/test.txt )
                        Jenkinsfile.sh(cp /microscanner.log  || true)
                        Jenkinsfile.archiveArtifacts({artifacts=test.txt, *.log, excludes=null, fingerprint=false, onlyIfSuccessful=false})
                        Jenkinsfile.dockerFingerprintFrom({dockerfile=./Dockerfile, image=nabla/jenkins-pipeline-scripts-test:test})
            Jenkinsfile.stage(➕ Quality - E2E tests, groovy.lang.Closure)
               Jenkinsfile.when(groovy.lang.Closure)
                  Jenkinsfile.expression(groovy.lang.Closure)
                  Jenkinsfile.expression(groovy.lang.Closure)
               Jenkinsfile.steps(groovy.lang.Closure)
                  Jenkinsfile.script(groovy.lang.Closure)
                     Jenkinsfile.parallel({sample default maven project=groovy.lang.Closure})
                        Jenkinsfile.build({job=github.com/AlbanAndrieu/nabla-servers-bower-sample/master, propagate=false, wait=true})
                     Jenkinsfile.echo(E2E FAILURE)
                     Jenkinsfile.echo(WARNING : There was a problem with e2e job test java.lang.RuntimeException: sample default maven project - Cannot get property 'result' on null object)
         Jenkinsfile.post(groovy.lang.Closure)
            Jenkinsfile.always(groovy.lang.Closure)
               Jenkinsfile.node(any||flyweight, groovy.lang.Closure)
                  Jenkinsfile.taskScanner()
                  Jenkinsfile.tagList()
                  Jenkinsfile.recordIssues({enabledForFailure=true, tools=[null, null]})
                  Jenkinsfile.withLogParser({unstableOnWarning=false})
